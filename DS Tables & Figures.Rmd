---
title: "DS Tables & Figures"
author: "Aushanae Haller"
date: '2022-03-23'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(arsenal)
library(Hmisc)
library(data.table)
```


```{r}
# Demographics Table

demographics <- demographics_df %>%
  select(-dyadID) %>% 
  mutate(gender =
           case_when(gender == "Man" | gender == "Man,Cis gendered" ~ "Man",
                     gender == "Woman" | gender == "Woman,Cis gendered" ~ "Woman")
  )

my_labels <- list(
  race = "Race",
  birthday = "Age",
  sexualor = "Seuxal Orientation"
)

table_one <- tableby(gender ~ ., data = demographics, test = FALSE) 
summary(table_one, labelTranslations = my_labels, title = "Demographic Data") 
```

```{r}
# Correlations between Study Variables

vars <- pairwise_df %>% 
  select(relation_qual.avg_A, self_object.tavg_A, other_object.tavg_A) %>% 
  rename("Relationship Quality" = relation_qual.avg_A,
         "Self Objectification" = self_object.tavg_A,
         "Other Objectification" = other_object.tavg_A)

cor_table <- round(cor(vars, use="complete.obs"), 2)

cor_table[upper.tri(cor_table)]<-""

correlation <- as.data.frame(cor_table) %>% 
  mutate(M = 0, SD = 0)

correlation$M[1] <- mean(vars$`Relationship Quality`, na.rm = TRUE)
correlation$M[2] <- mean(vars$`Self Objectification`, na.rm = TRUE)
correlation$M[3] <- mean(vars$`Other Objectification`, na.rm = TRUE)
correlation$SD[1] <- sd(vars$`Relationship Quality`, na.rm = TRUE)
correlation$SD[2] <- sd(vars$`Self Objectification`, na.rm = TRUE)
correlation$SD[3] <- sd(vars$`Other Objectification`, na.rm = TRUE)

correlation <- correlation[, c(4, 5, 1, 2, 3)]

correlation
```

